yum -y install gcc gcc-c++ make automake libtool gettext openssl-devel libevent-devel intltool libiconv curl-devel wget

wget https://build.transmissionbt.com/job/trunk-linux/lastSuccessfulBuild/artifact/transmission-master-r44fc571a67.tar.xz
tar xf transmission-master-r44fc571a67.tar.xz && cd transmission-3.00+

./autogen.sh && make && make install

##添加运行用户
useradd transmission

##默认配置文件
##/root/.config/transmission-daemon

##初始化transmission配置文件 
transmission-daemon -g /web_home/download


##crate service
cat >/etc/systemd/system/bt.service<< EOF


[Unit]
Description=Transmission BitTorrent Daemon
After=network.target
[Service]
User=transmission
Type=simple
ExecStart=/usr/local/bin/transmission-daemon -g /web_home/download -f --log-error
ExecReload=/bin/kill -s HUP $MAINPID
NoNewPrivileges=true

[Install]
WantedBy=multi-user.target
EOF

##systemctl status transmission-daemon.service
##systemctl start transmission-daemon.service
##systemctl stop transmission-daemon.service

##vi /web_home/download/settings.json
## change config
    "rpc-host-whitelist-enabled": true,
    "rpc-password": "{0d26d999c3c02d7be13ec0f705029558044c2b12U0YDDyPj",


firewall-cmd --zone=public --add-port=51413/tcp --permanent
firewall-cmd --zone=public --add-port=51413/udp --permanent
firewall-cmd --zone=public --add-port=9091/tcp --permanent
firewall-cmd --zone=public --add-port=9091/udp --permanent
firewall-cmd --reload

wget https://github.com/ronggang/transmission-web-control/archive/v1.6.0-beta2.tar.gz

tar zxvf v1.6.0-beta2.tar.gz

mv /usr/local/share/transmission/web /usr/local/share/transmission/web_backup
mkdir /usr/local/share/transmission/web/
cp -r /root/transmission-web-control-1.6.0-beta2/src/* /usr/local/share/transmission/web/
